<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Terra Dotta Pricing Generator</title>
    <!-- 1. Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 2. Load React Libraries -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- 3. Load Babel to transpile JSX in the browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        /* A little animation for the notification */
        @keyframes slide-in-right {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        .animate-slide-in-right {
            animation: slide-in-right 0.5s forwards;
        }
    </style>
</head>
<body>
    <!-- 4. The HTML element where our React app will be rendered -->
    <div id="root"></div>

    <!-- 5. Your React application code, with type="text/babel" -->
    <script type="text/babel">
      const { useState, useMemo, useCallback, useEffect } = React;

      // --- SVG Icons (replacement for lucide-react) ---
      const Plus = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>;
      const Trash2 = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>;
      const Calculator = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="8" y1="6" x2="16" y2="6"></line><line x1="16" y1="14" x2="16" y2="18"></line><g fill="currentColor"><circle cx="12" cy="10" r="1"></circle><circle cx="12" cy="14" r="1"></circle><circle cx="12" cy="18" r="1"></circle><circle cx="8" cy="10" r="1"></circle><circle cx="8" cy="14" r="1"></circle><circle cx="8" cy="18" r="1"></circle><circle cx="16" cy="10" r="1"></circle></g></svg>;
      const DollarSign = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="1" x2="12" y2="23"></line><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path></svg>;
      const X = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>;
      const CheckCircle = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>;
      const Copy = () => <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>;

      // --- Data Constants ---
      const productPrices = {
        'Study Abroad': { '0 - 100': 8700, '101 - 200': 11872, '201 - 300': 15044, '301 - 400': 18217, '401 - 500': 21389, '501 - 600': 24561, '601 - 700': 27733, '701 - 800': 30906, '800 - 900': 34078, '901 - 1,000': 37250, '1,001 - 1,100': 42250, '1,101 - 1,250': 43500, '1,251 - 1,500': 47250, '1,501 - 2,000': 52250, '2,001 - 3,500': 56000, '3,501 - 6,000': 62250, '6,001 - 11,000+': 72250 },
        'ISSS': { '0 - 100': 10500, '101 - 200': 14861, '201 - 300': 19222, '301 - 400': 23583, '401 - 500': 27944, '501 - 600': 32306, '601 - 700': 36667, '701 - 800': 41028, '800 - 900': 45389, '901 - 1,000': 49750, '1,001 - 1,100': 54750, '1,101 - 1,250': 56000, '1,251 - 1,500': 59750, '1,501 - 2,000': 64750, '2,001 - 3,500': 68500, '3,501 - 6,000': 74750, '6,001 - 11,000+': 84750 },
        'Enterprise Travel Registry': { '0 - 100': 6100, '101 - 200': 8061, '201 - 300': 10022, '301 - 400': 11983, '401 - 500': 13944, '501 - 600': 15906, '601 - 700': 17867, '701 - 800': 19828, '800 - 900': 21789, '901 - 1,000': 23750, '1,001 - 1,100': 28750, '1,101 - 1,250': 30000, '1,251 - 1,500': 33750, '1,501 - 2,000': 38750, '2,001 - 3,500': 42500, '3,501 - 6,000': 48750, '6,001 - 11,000+': 58750 },
        'AlertTraveler': { '0 - 100': 4750, '101 - 200': 5442, '201 - 300': 6133, '301 - 400': 6825, '401 - 500': 7517, '501 - 600': 8208, '601 - 700': 8900, '701 - 800': 9592, '800 - 900': 10283, '901 - 1,000': 10975, '1,001 - 1,100': 15975, '1,101 - 1,250': 17225, '1,251 - 1,500': 20975, '1,501 - 2,000': 25975, '2,001 - 3,500': 29725, '3,501 - 6,000': 35975, '6,001 - 11,000+': 45975 },
        'Engage for SA': { '0 - 100': 2871, '101 - 200': 3918, '201 - 300': 4965, '301 - 400': 6012, '401 - 500': 7058, '501 - 600': 8105, '601 - 700': 9152, '701 - 800': 10199, '800 - 900': 11246, '901 - 1,000': 12293, '1,001 - 1,100': 13943, '1,101 - 1,250': 14355, '1,251 - 1,500': 15593, '1,501 - 2,000': 17243, '2,001 - 3,500': 18480, '3,501 - 6,000': 20543, '6,001 - 11,000+': 23843 },
        'Engage for ISSS': { '0 - 100': 3465, '101 - 200': 4904, '201 - 300': 6343, '301 - 400': 7782, '401 - 500': 9222, '501 - 600': 10661, '601 - 700': 12100, '701 - 800': 13539, '800 - 900': 14978, '901 - 1,000': 16418, '1,001 - 1,100': 18068, '1,101 - 1,250': 18480, '1,251 - 1,500': 19718, '1,501 - 2,000': 21368, '2,001 - 3,500': 22605, '3,501 - 6,000': 24668, '6,001 - 11,000+': 27968 },
        'Agreements': { all: 9500 },
        'Dashboards': { all: 5000 },
        'Payment Gateway': { all: 1000 }
      };

      const implementationCosts = {
        'Study Abroad': { '0 - 100': 12000, '101 - 200': 12000, '201 - 300': 12000, '301 - 400': 12000, '401 - 500': 12000, '501 - 600': 13500, '601 - 700': 13500, '701 - 800': 13500, '800 - 900': 13500, '901 - 1,000': 13500, '1,001 - 1,100': 15000, '1,101 - 1,250': 15000, '1,251 - 1,500': 15000, '1,501 - 2,000': 15000, '2,001 - 3,500': 15000, '3,501 - 6,000': 15000, '6,001 - 11,000+': 15000 },
        'ISSS': { all: 21750 },
        'AlertTraveler': { all: 1500 },
        'Engage for SA': { all: 1500 },
        'Engage for ISSS': { all: 1500 },
        'Enterprise Travel Registry': { all: 9000 },
        'Dashboards': { all: 5000 },
        'Agreements': { all: 6000 },
        'Payment Gateway': { all: 1000 }
      };

      const availableProducts = Object.keys(productPrices);
      const bandOptions = [
        '0 - 100', '101 - 200', '201 - 300', '301 - 400', '401 - 500', '501 - 600', '601 - 700', 
        '701 - 800', '800 - 900', '901 - 1,000', '1,001 - 1,100', '1,101 - 1,250', '1,251 - 1,500', 
        '1,501 - 2,000', '2,001 - 3,500', '3,501 - 6,000', '6,001 - 11,000+', '-'
      ];
      
      const STANDARD_ESCALATOR = 5;

      const getProductPrice = (productName, band) => {
          if (productPrices[productName]?.all) return productPrices[productName].all;
          return productPrices[productName]?.[band] || 0;
      };

      const getImplementationCost = (productName, band) => {
          if (productName === 'Study Abroad') return implementationCosts['Study Abroad'][band] || 15000;
          return implementationCosts[productName]?.all || 0;
      };
      
      // --- React Components ---

      const Modal = ({ isOpen, onClose, onConfirm, title, children }) => {
        if (!isOpen) return null;

        return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50">
                <div className="bg-white p-6 rounded-lg shadow-xl w-full max-w-md">
                    <h2 className="text-lg font-bold mb-4">{title}</h2>
                    <div className="mb-6">{children}</div>
                    <div className="flex justify-end gap-4">
                        <button onClick={onClose} className="px-4 py-2 rounded-lg bg-slate-200 hover:bg-slate-300 transition-colors">No</button>
                        <button onClick={onConfirm} className="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 transition-colors">Yes</button>
                    </div>
                </div>
            </div>
        );
      };

      const Notification = ({ message, type, onDismiss }) => {
        if (!message) return null;

        const baseStyle = "fixed top-5 right-5 flex items-center px-6 py-3 rounded-lg shadow-lg text-white transition-all duration-300 transform animate-slide-in-right z-50";
        const typeStyles = {
          success: "bg-green-500",
          error: "bg-red-500",
        };

        return (
          <div className={`${baseStyle} ${typeStyles[type]}`}>
            <div className="w-5 h-5"><CheckCircle /></div>
            <span className="font-medium mx-3">{message}</span>
            <button onClick={onDismiss} className="ml-auto p-1 rounded-full hover:bg-white/20 transition-colors">
              <div className="w-5 h-5"><X /></div>
            </button>
          </div>
        );
      };

      const App = () => {
        const [products, setProducts] = useState([
          { 
            id: 1,
            name: 'Study Abroad', 
            band: '201 - 300', 
            listPrice: 15044, 
            discount: { type: 'percentage', value: 20 }, 
            hasImplementation: false,
            showUnlimited: false,
            implementationCost: 12000,
            implementationDiscount: { type: 'percentage', value: 10 },
            waiveYear1: false,
            waiveImplementation: false,
            isCurrentSolution: false,
            spreadImplementation: false,
          }
        ]);
        const [term, setTerm] = useState(5);
        const [escalator, setEscalator] = useState(3);
        const [modal, setModal] = useState({ isOpen: false, productIndex: null });
        
        const getNextMonthEndDate = () => {
            const date = new Date();
            date.setMonth(date.getMonth() + 2, 0);
            return date.toISOString().split('T')[0];
        }

        const [validThrough, setValidThrough] = useState(getNextMonthEndDate());
        const [notification, setNotification] = useState({ message: '', type: 'success' });

        useEffect(() => {
          if (notification.message) {
            const timer = setTimeout(() => {
              setNotification({ message: '', type: 'success' });
            }, 3000);
            return () => clearTimeout(timer);
          }
        }, [notification]);

        const showNotification = (message, type = 'success') => {
          setNotification({ message, type });
        };

        const formattedDate = useMemo(() => {
          try {
            const date = new Date(validThrough + 'T00:00:00');
            const day = date.getDate();
            const month = date.toLocaleDateString('en-US', { month: 'long' });
            const year = date.getFullYear();
            
            const getOrdinal = (n) => {
              if (n >= 11 && n <= 13) return n + "th";
              switch (n % 10) {
                case 1: return n + "st";
                case 2: return n + "nd";
                case 3: return n + "rd";
                default: return n + "th";
              }
            };
            
            return `${month} ${getOrdinal(day)}, ${year}`;
          } catch (error) {
            return validThrough;
          }
        }, [validThrough]);

        const copyToPowerPoint = useCallback(() => {
          try {
            const pricingTable = document.querySelector('#pricing-table-for-copy');
            if (!pricingTable) {
              showNotification('Copy failed: Pricing table not found.', 'error');
              return;
            }
            const range = document.createRange();
            range.selectNode(pricingTable);
            
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            
            const successful = document.execCommand('copy');
            window.getSelection().removeAllRanges();
            
            if (successful) {
              showNotification('âœ… Pricing table copied successfully!');
            } else {
              showNotification('Copy failed. Please try selecting the table manually.', 'error');
            }
          } catch (err) {
            showNotification('Copy failed. An error occurred.', 'error');
          }
        }, [formattedDate, escalator, term, products]);

        const handleImplementationChange = (index, isChecked) => {
            if (isChecked) {
                setModal({ isOpen: true, productIndex: index });
            } else {
                const newProducts = [...products];
                newProducts[index] = {
                    ...newProducts[index],
                    hasImplementation: false,
                    spreadImplementation: false,
                };
                setProducts(newProducts);
            }
        };
        
        const confirmSpread = (shouldSpread) => {
            const { productIndex } = modal;
            if (productIndex !== null) {
                const newProducts = [...products];
                newProducts[productIndex].hasImplementation = true;
                newProducts[productIndex].spreadImplementation = shouldSpread;
                setProducts(newProducts);
            }
            setModal({ isOpen: false, productIndex: null });
        };

        const updateProduct = (index, field, value) => {
          const newProducts = [...products];
          const productToUpdate = { ...newProducts[index] };

          if (field === 'discount' || field === 'implementationDiscount') {
            productToUpdate[field] = value;
          } else if (field === 'band' || field === 'name') {
            productToUpdate[field] = value;
            const newName = field === 'name' ? value : productToUpdate.name;
            const newBand = field === 'band' ? value : productToUpdate.band;
            productToUpdate.listPrice = getProductPrice(newName, newBand);
            productToUpdate.implementationCost = getImplementationCost(newName, newBand);
          } else {
            productToUpdate[field] = value;
          }
          newProducts[index] = productToUpdate;
          setProducts(newProducts);
        };

        const addProduct = () => {
          setProducts([...products, { 
            id: Date.now(),
            name: 'Study Abroad', 
            band: '0 - 100', 
            listPrice: getProductPrice('Study Abroad', '0 - 100'), 
            discount: { type: 'percentage', value: 0 }, 
            hasImplementation: false,
            showUnlimited: false,
            implementationCost: getImplementationCost('Study Abroad', '0 - 100'),
            implementationDiscount: { type: 'percentage', value: 0 },
            waiveYear1: false,
            waiveImplementation: false,
            isCurrentSolution: false,
            spreadImplementation: false,
          }]);
        };

        const removeProduct = (index) => {
          if (products.length > 1) setProducts(products.filter((_, i) => i !== index));
        };

        const calculateYearlyPrice = (basePrice, year, escalatorRate) => Math.round(basePrice * Math.pow(1 + escalatorRate / 100, year - 1));

        const calculateDiscountedPrice = (price, discount) => {
          const discountValue = discount.value === '' ? 0 : (typeof discount.value === 'string' ? parseInt(discount.value, 10) || 0 : discount.value);
          if (discount.type === 'percentage') return price - Math.round(price * discountValue / 100);
          return price - discountValue;
        };
        
        const formatCurrency = (amount) => '$' + amount.toLocaleString();

        const getDiscountDisplay = (price, discount) => {
            const discountValue = discount.value === '' ? 0 : (typeof discount.value === 'string' ? parseInt(discount.value, 10) || 0 : discount.value);
            if (discountValue === 0) return '-';

            if (discount.type === 'percentage') {
                return `${discountValue}%`;
            }
            if (discount.type === 'dollar') {
                if (price === 0) return '-%';
                const percentage = Math.round((discountValue / price) * 100);
                return `${percentage}%`;
            }
            return '-';
        };

        const calculateTotalSavings = useCallback(() => {
          let totalStandardListPrice = 0;
          let totalDiscountedPrice = 0;

          products.forEach(product => {
            for (let year = 1; year <= term; year++) {
              const standardYearlyListPrice = calculateYearlyPrice(product.listPrice, year, STANDARD_ESCALATOR);
              totalStandardListPrice += standardYearlyListPrice;

              const yearlyListPriceWithActualEscalator = calculateYearlyPrice(product.listPrice, year, escalator);
              const discountedPrice = calculateDiscountedPrice(yearlyListPriceWithActualEscalator, product.discount);
              const finalPrice = product.waiveYear1 && year === 1 ? 0 : discountedPrice;
              totalDiscountedPrice += finalPrice;
            }

            if (product.hasImplementation) {
              totalStandardListPrice += product.implementationCost;
              const implementationFinalCost = product.waiveImplementation ? 0 : calculateDiscountedPrice(product.implementationCost, product.implementationDiscount);
              totalDiscountedPrice += implementationFinalCost;
            }
          });

          return { totalStandardListPrice, totalDiscountedPrice, totalSavings: totalStandardListPrice - totalDiscountedPrice };
        }, [products, term, escalator]);

        const calculateAverageDiscount = useCallback(() => {
          if (products.length === 0) return 0;
          
          let totalListPriceValue = 0;
          let totalDiscountValue = 0;
          
          products.forEach(product => {
            let waivedYear1Discount = 0;
            for (let year = 1; year <= term; year++) {
              const yearlyPrice = calculateYearlyPrice(product.listPrice, year, escalator);
              totalListPriceValue += yearlyPrice;
              
              const discountAmount = product.discount.type === 'percentage' 
                ? Math.round(yearlyPrice * (parseInt(product.discount.value, 10) || 0) / 100)
                : (parseInt(product.discount.value, 10) || 0);
              totalDiscountValue += discountAmount;

              if (product.waiveYear1 && year === 1) {
                  waivedYear1Discount = yearlyPrice - discountAmount;
              }
            }
            totalDiscountValue += waivedYear1Discount;
            
            if (product.hasImplementation) {
              const implCost = product.implementationCost;
              totalListPriceValue += implCost;
              
              const implDiscountAmount = product.implementationDiscount.type === 'percentage'
                ? Math.round(implCost * (parseInt(product.implementationDiscount.value, 10) || 0) / 100)
                : (parseInt(product.implementationDiscount.value, 10) || 0);
              totalDiscountValue += implDiscountAmount;
              
              if (product.waiveImplementation) {
                totalDiscountValue += (implCost - implDiscountAmount);
              }
            }
          });
          
          if (totalListPriceValue === 0) return 0;
          return Math.round((totalDiscountValue / totalListPriceValue) * 100);
        }, [products, term, escalator]);

        const totals = useMemo(() => calculateTotalSavings(), [calculateTotalSavings]);
        const averageDiscount = useMemo(() => calculateAverageDiscount(), [calculateAverageDiscount]);
        const hasCurrentSolution = useMemo(() => products.some(p => p.isCurrentSolution), [products]);

        return (
          <div className="min-h-screen bg-slate-50 font-sans">
            <Modal
                isOpen={modal.isOpen}
                onClose={() => confirmSpread(false)}
                onConfirm={() => confirmSpread(true)}
                title="Implementation Cost">
                <p>Spread Implementation over the Term?</p>
            </Modal>
            <Notification message={notification.message} type={notification.type} onDismiss={() => setNotification({ message: '', type: 'success' })} />
            <div className="max-w-7xl mx-auto p-4 sm:p-6">
              <div className="bg-white rounded-2xl shadow-xl overflow-hidden border border-slate-200">
                <div className="bg-gradient-to-r from-blue-600 to-blue-700 text-white p-5 sm:p-6">
                  <div className="flex flex-wrap items-center justify-between gap-4">
                    <div className="flex items-center gap-3">
                      <div className="w-8 h-8"><Calculator /></div>
                      <h1 className="text-xl sm:text-2xl font-bold">Terra Dotta Pricing Generator</h1>
                    </div>
                    <div className="flex items-center gap-3">
                      <button 
                        onClick={addProduct} 
                        className="bg-white/20 hover:bg-white/30 backdrop-blur-sm px-4 py-2 rounded-lg flex items-center gap-2 text-sm font-medium transition-all duration-200 hover:scale-105"
                      >
                        <div className="w-4 h-4"><Plus /></div>
                        Add Product
                      </button>
                    </div>
                  </div>
                </div>

                <div className="border-b border-slate-200 bg-slate-50/50 p-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div className="space-y-2">
                      <label className="block text-sm font-semibold text-slate-700">Contract Term</label>
                      <select 
                        value={term} 
                        onChange={(e) => setTerm(parseInt(e.target.value))} 
                        className="w-full border border-slate-300 rounded-lg px-4 py-2.5 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                      >
                        {[1,2,3,4,5,6,7,8,9,10].map(y => (
                          <option key={y} value={y}>{y} Year{y > 1 ? 's' : ''}</option>
                        ))}
                      </select>
                    </div>
                    <div className="space-y-2">
                      <label className="block text-sm font-semibold text-slate-700">Annual Escalator (%)</label>
                      <input 
                        type="number" 
                        min="0" 
                        max="20" 
                        value={escalator} 
                        onChange={(e) => setEscalator(parseInt(e.target.value) || 0)} 
                        className="w-full border border-slate-300 rounded-lg px-4 py-2.5 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                      />
                    </div>
                    <div className="space-y-2">
                      <label className="block text-sm font-semibold text-slate-700">Valid Through</label>
                      <input 
                        type="date" 
                        value={validThrough} 
                        onChange={(e) => setValidThrough(e.target.value)} 
                        className="w-full border border-slate-300 rounded-lg px-4 py-2.5 bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                      />
                      <div className="text-sm text-slate-600">
                        Will display as: {formattedDate}
                      </div>
                    </div>
                  </div>
                </div>

                <div className="p-4 sm:p-6">
                  <div className="bg-white">
                    <h2 className="text-2xl sm:text-3xl font-bold text-center mb-8 text-slate-800">
                      Product & Discount Configuration
                    </h2>

                    <div className="space-y-6 mb-10">
                      {products.map((product, index) => (
                        <div key={product.id} className="border border-slate-200 rounded-xl p-5 sm:p-6 bg-slate-50/30 shadow-sm hover:shadow-md transition-shadow">
                          <div className="flex items-center justify-between mb-4">
                            <h3 className="font-bold text-lg text-slate-800 flex items-center gap-2">
                              <div className="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-sm">
                                {index + 1}
                              </div>
                              Product Details
                            </h3>
                            {products.length > 1 && (
                              <button 
                                onClick={() => removeProduct(index)} 
                                className="text-red-500 hover:text-red-700 hover:bg-red-100 p-2 rounded-lg transition-colors"
                                aria-label="Remove product"
                              >
                                <div className="w-5 h-5"><Trash2 /></div>
                              </button>
                            )}
                          </div>
                          
                          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4">
                              <div className="lg:col-span-1 space-y-2">
                                  <label className="block text-xs font-semibold text-slate-600 uppercase tracking-wide">Product</label>
                                  <select 
                                  value={product.name} 
                                  onChange={(e) => updateProduct(index, 'name', e.target.value)} 
                                  className="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                  >
                                  {availableProducts.map(p => (<option key={p} value={p}>{p}</option>))}
                                  </select>
                              </div>
                              <div className="lg:col-span-1 space-y-2">
                                  <label className="block text-xs font-semibold text-slate-600 uppercase tracking-wide">Band</label>
                                  <select 
                                  value={product.band} 
                                  onChange={(e) => updateProduct(index, 'band', e.target.value)} 
                                  className="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                  >
                                  {bandOptions.map(b => (<option key={b} value={b}>{b}</option>))}
                                  </select>
                              </div>
                              <div className="space-y-2">
                                  <label className="block text-xs font-semibold text-slate-600 uppercase tracking-wide">List Price</label>
                                  <input 
                                  type="number" 
                                  value={product.listPrice} 
                                  onChange={(e) => updateProduct(index, 'listPrice', parseInt(e.target.value) || 0)} 
                                  className="w-full border border-slate-300 rounded-lg px-3 py-2 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                  />
                              </div>
                              <div className="space-y-2">
                                  <label className="block text-xs font-semibold text-slate-600 uppercase tracking-wide">Discount</label>
                                  <div className="flex rounded-lg overflow-hidden border border-slate-300 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500">
                                  <select 
                                      value={product.discount.type} 
                                      onChange={(e) => updateProduct(index, 'discount', {...product.discount, type: e.target.value})} 
                                      className="border-0 px-2 py-2 text-sm w-14 bg-slate-100 focus:ring-0"
                                  >
                                      <option value="percentage">%</option>
                                      <option value="dollar">$</option>
                                  </select>
                                  <input 
                                      type="number" 
                                      value={product.discount.value} 
                                      onChange={(e) => updateProduct(index, 'discount', {...product.discount, value: e.target.value === '' ? '' : parseInt(e.target.value, 10) || 0})} 
                                      className="border-0 px-3 py-2 text-sm flex-1 focus:ring-0 bg-white"
                                  />
                                  </div>
                              </div>
                          </div>

                          <div className="mt-4 pt-4 border-t border-slate-200">
                              <div className="flex flex-wrap items-center gap-x-8 gap-y-2">
                                  <label className="flex items-center cursor-pointer space-x-2">
                                      <input 
                                      type="checkbox" 
                                      checked={product.showUnlimited} 
                                      onChange={(e) => updateProduct(index, 'showUnlimited', e.target.checked)} 
                                      className="w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500"
                                      />
                                      <span className="text-sm font-medium text-slate-700">Unlimited</span>
                                  </label>
                                  <label className="flex items-center cursor-pointer space-x-2">
                                      <input 
                                      type="checkbox" 
                                      checked={product.waiveYear1} 
                                      onChange={(e) => updateProduct(index, 'waiveYear1', e.target.checked)} 
                                      className="w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500"
                                      />
                                      <span className="text-sm font-medium text-slate-700">Waive Year 1</span>
                                  </label>
                                  <label className="flex items-center cursor-pointer space-x-2">
                                      <input 
                                      type="checkbox" 
                                      checked={product.hasImplementation} 
                                      onChange={(e) => handleImplementationChange(index, e.target.checked)}
                                      className="w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500"
                                      />
                                      <span className="text-sm font-medium text-slate-700">Include Implementation</span>
                                  </label>
                              </div>
                              <div className="mt-2">
                                <label className="flex items-center cursor-pointer space-x-2">
                                      <input 
                                      type="checkbox" 
                                      checked={product.isCurrentSolution} 
                                      onChange={(e) => updateProduct(index, 'isCurrentSolution', e.target.checked)} 
                                      className="w-4 h-4 text-blue-600 border-slate-300 rounded focus:ring-blue-500"
                                      />
                                      <span className="text-sm font-medium text-slate-700">Currently Used Solution</span>
                                </label>
                              </div>
                          </div>

                          {product.hasImplementation && (
                          <div className="mt-4 pt-4 border-t border-dashed border-blue-200">
                              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-blue-50/50 rounded-lg">
                              <div className="space-y-2">
                                  <label className="block text-xs font-semibold text-blue-700 uppercase tracking-wide">Implementation Cost</label>
                                  <input 
                                  type="number" 
                                  value={product.implementationCost} 
                                  onChange={(e) => updateProduct(index, 'implementationCost', parseInt(e.target.value) || 0)} 
                                  className="w-full border border-blue-300 rounded-lg px-3 py-2 text-sm bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"
                                  />
                              </div>
                              <div className="space-y-2">
                                  <label className="block text-xs font-semibold text-blue-700 uppercase tracking-wide">Implementation Discount</label>
                                  <div className="flex rounded-lg overflow-hidden border border-blue-300 focus-within:ring-2 focus-within:ring-blue-500 focus-within:border-blue-500">
                                  <select 
                                      value={product.implementationDiscount.type} 
                                      onChange={(e) => updateProduct(index, 'implementationDiscount', {...product.implementationDiscount, type: e.target.value})} 
                                      className="border-0 px-2 py-2 text-sm w-14 bg-blue-100 focus:ring-0"
                                  >
                                      <option value="percentage">%</option>
                                      <option value="dollar">$</option>
                                  </select>
                                  <input 
                                      type="number" 
                                      value={product.implementationDiscount.value} 
                                      onChange={(e) => updateProduct(index, 'implementationDiscount', {...product.implementationDiscount, value: e.target.value === '' ? '' : parseInt(e.target.value, 10) || 0})} 
                                      className="border-0 px-3 py-2 text-sm flex-1 focus:ring-0 bg-white"
                                  />
                                  </div>
                              </div>
                              <div className="space-y-2 flex items-end">
                                  <label className="flex items-center cursor-pointer space-x-2 pb-2">
                                      <input 
                                      type="checkbox" 
                                      checked={product.waiveImplementation} 
                                      onChange={(e) => updateProduct(index, 'waiveImplementation', e.target.checked)} 
                                      className="w-4 h-4 text-blue-600 border-blue-300 rounded focus:ring-blue-500"
                                      />
                                      <span className="text-sm font-medium text-blue-700">Waive Implementation</span>
                                  </label>
                              </div>
                              </div>
                          </div>
                          )}
                        </div>
                      ))}
                    </div>

                    <div id="pricing-table-for-copy" style={{position: 'absolute', left: '-9999px', top: 'auto', width: '800px'}}>
                        <table style={{borderCollapse: 'collapse', width: '100%', fontFamily: 'sans-serif', fontSize: '11pt'}}>
                            <thead>
                                <tr>
                                    <td colSpan={4 + term + 1} style={{padding: '8px', backgroundColor: '#f0f0f0', border: '1px solid #cccccc', fontWeight: 'bold'}}>
                                        Valid through {formattedDate} with a {escalator}% Annual Escalator
                                        {escalator < STANDARD_ESCALATOR && <span style={{fontWeight: 'normal', fontStyle: 'italic'}}> (Standard is {STANDARD_ESCALATOR}%)</span>}
                                    </td>
                                </tr>
                                <tr style={{backgroundColor: '#00aeef', color: 'white', fontWeight: 'bold', textAlign: 'center'}}>
                                    <th style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'left'}}>Solution</th>
                                    <th style={{border: '1px solid #cccccc', padding: '8px'}}>Band</th>
                                    <th style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>List Price</th>
                                    <th style={{border: '1px solid #cccccc', padding: '8px'}}>Discount</th>
                                    {Array.from({length: term}, (_, i) => (
                                        <th key={i} style={{border: '1px solid #cccccc', padding: '8px'}}>Year {i + 1}</th>
                                    ))}
                                    <th style={{border: '1px solid #cccccc', padding: '8px', backgroundColor: '#f57922'}}>Total</th>
                                </tr>
                            </thead>
                            <tbody>
                            {products.map((product, productIndex) => {
                                const yearlyPrices = Array.from({length: term}, (_, i) => {
                                    const yearlyPrice = calculateYearlyPrice(product.listPrice, i + 1, escalator);
                                    return calculateDiscountedPrice(yearlyPrice, product.discount);
                                });
                                const productSubscriptionTotal = yearlyPrices.reduce((sum, price, i) => sum + (product.waiveYear1 && i === 0 ? 0 : price), 0);
                                const rowBg = product.isCurrentSolution ? '#e5e7eb' : (productIndex % 2 === 0 ? '#f8f8f8' : '#ffffff');
                                return (
                                    <React.Fragment key={`copy-${product.id}`}>
                                        <tr style={{backgroundColor: rowBg}}>
                                            <td style={{border: '1px solid #cccccc', padding: '8px', fontWeight: 'bold'}}>{product.name}{product.isCurrentSolution ? '*' : ''}</td>
                                            <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>{product.showUnlimited ? 'Unlimited' : product.band}</td>
                                            <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>{formatCurrency(product.listPrice)}</td>
                                            <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>{getDiscountDisplay(product.listPrice, product.discount)}</td>
                                            {yearlyPrices.map((price, yearIndex) => (
                                                <td key={yearIndex} style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>
                                                    {product.waiveYear1 && yearIndex === 0 ? 'WAIVED' : formatCurrency(price)}
                                                </td>
                                            ))}
                                            <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right', fontWeight: 'bold', backgroundColor: '#fef3e2'}}>{formatCurrency(productSubscriptionTotal)}</td>
                                        </tr>
                                        {product.hasImplementation && (
                                            <tr style={{backgroundColor: rowBg}}>
                                                <td style={{border: '1px solid #cccccc', padding: '8px', paddingLeft: '24px'}}>Implementation</td>
                                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>-</td>
                                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>{formatCurrency(product.implementationCost)}</td>
                                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>{getDiscountDisplay(product.implementationCost, product.implementationDiscount)}</td>
                                                {Array.from({length: term}, (_, yearIndex) => {
                                                    const discountedImplCost = product.waiveImplementation ? 0 : calculateDiscountedPrice(product.implementationCost, product.implementationDiscount);
                                                    let displayValue = '-';
                                                    if(discountedImplCost > 0) {
                                                        if (product.spreadImplementation) {
                                                            displayValue = formatCurrency(Math.round(discountedImplCost / term));
                                                        } else if (yearIndex === 0) {
                                                            displayValue = formatCurrency(discountedImplCost);
                                                        }
                                                    }
                                                    return (
                                                        <td key={yearIndex} style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>
                                                            {product.waiveImplementation ? 'WAIVED' : displayValue}
                                                        </td>
                                                    );
                                                })}
                                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right', fontWeight: 'bold', backgroundColor: '#fef3e2'}}>
                                                    {product.waiveImplementation ? 'WAIVED' : formatCurrency(calculateDiscountedPrice(product.implementationCost, product.implementationDiscount))}
                                                </td>
                                            </tr>
                                        )}
                                    </React.Fragment>
                                );
                            })}
                              <tr style={{backgroundColor: '#333333', color: 'white', fontWeight: 'bold'}}>
                                <td style={{border: '1px solid #cccccc', padding: '8px'}}>TOTAL</td>
                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>-</td>
                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>
                                  {formatCurrency(products.reduce((sum, p) => sum + p.listPrice + (p.hasImplementation ? p.implementationCost : 0), 0))}
                                </td>
                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'center'}}>{averageDiscount}%</td>
                                {Array.from({length: term}, (_, yearIndex) => {
                                    const yearTotal = products.reduce((sum, product) => {
                                        const yearlyPrice = calculateYearlyPrice(product.listPrice, yearIndex + 1, escalator);
                                        const discountedPrice = calculateDiscountedPrice(yearlyPrice, product.discount);
                                        let finalPrice = product.waiveYear1 && yearIndex === 0 ? 0 : discountedPrice;
                                        if (product.hasImplementation && !product.waiveImplementation) {
                                            const implCost = calculateDiscountedPrice(product.implementationCost, product.implementationDiscount);
                                            if (product.spreadImplementation) {
                                                finalPrice += Math.round(implCost / term);
                                            } else if (yearIndex === 0) {
                                                finalPrice += implCost;
                                            }
                                        }
                                        return sum + finalPrice;
                                    }, 0);
                                    return <td key={yearIndex} style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right'}}>{formatCurrency(yearTotal)}</td>;
                                })}
                                <td style={{border: '1px solid #cccccc', padding: '8px', textAlign: 'right', backgroundColor: '#f57922'}}>{formatCurrency(totals.totalDiscountedPrice)}</td>
                              </tr>
                               {hasCurrentSolution && (
                                <tr>
                                    <td colSpan={4 + term + 1} style={{padding: '4px 8px', fontSize: '9pt', fontStyle: 'italic'}}>
                                        * Currently Used Solution
                                    </td>
                                </tr>
                               )}
                            </tbody>
                        </table>
                    </div>

                    <div className="flex flex-wrap justify-between items-center mb-4 p-3 bg-slate-100 rounded-lg border border-slate-200">
                        <div className="flex items-center gap-2">
                            <div className="w-4 h-4 text-blue-600"><DollarSign/></div>
                            <span className="text-sm font-semibold text-slate-800">
                                Valid through {formattedDate}
                            </span>
                        </div>
                        <div className="text-center">
                            <span className="text-sm font-semibold text-slate-800">{escalator}% Annual Escalator</span>
                            {escalator < STANDARD_ESCALATOR && (
                                <div className="text-xs text-slate-500 italic">Standard is {STANDARD_ESCALATOR}%</div>
                            )}
                        </div>
                    </div>

                    <div className="overflow-x-auto mb-4 rounded-xl border border-slate-200 shadow-lg">
                      <table className="w-full border-collapse min-w-[800px]">
                        <thead>
                          <tr style={{backgroundColor: '#00aeef'}} className="text-white">
                            <th className="border-r border-blue-400 px-4 py-4 text-left font-bold text-sm">Solution</th>
                            <th className="border-r border-blue-400 px-4 py-4 text-center font-bold text-sm">Band</th>
                            <th className="border-r border-blue-400 px-4 py-4 text-center font-bold text-sm">List Price</th>
                            <th className="border-r border-blue-400 px-4 py-4 text-center font-bold text-sm">Discount</th>
                            {Array.from({length: term}, (_, i) => (
                              <th key={i} className="border-r border-blue-400 px-4 py-4 text-center font-bold text-sm">Year {i + 1}</th>
                            ))}
                            <th className="px-4 py-4 text-center font-bold text-sm" style={{backgroundColor: '#f57922'}}>Total</th>
                          </tr>
                        </thead>
                        <tbody>
                          {products.map((product, productIndex) => {
                            const yearlyPrices = Array.from({length: term}, (_, i) => {
                              const yearlyPrice = calculateYearlyPrice(product.listPrice, i + 1, escalator);
                              return calculateDiscountedPrice(yearlyPrice, product.discount);
                            });
                            
                            const productSubscriptionTotal = yearlyPrices.reduce((sum, price, i) => sum + (product.waiveYear1 && i === 0 ? 0 : price), 0);
                            const rowColor = product.isCurrentSolution ? 'bg-slate-200' : (productIndex % 2 === 0 ? 'bg-slate-50/70' : 'bg-white');
                            
                            return (
                              <React.Fragment key={product.id}>
                                <tr className={`${rowColor} hover:bg-blue-50 transition-colors`}>
                                  <td className="border border-slate-200 px-4 py-3 font-semibold text-slate-800">{product.name}{product.isCurrentSolution ? '*' : ''}</td>
                                  <td className="border border-slate-200 px-4 py-3 text-center text-slate-700">{product.showUnlimited ? 'Unlimited' : product.band}</td>
                                  <td className="border border-slate-200 px-4 py-3 text-right text-slate-700">{formatCurrency(product.listPrice)}</td>
                                  <td className="border border-slate-200 px-4 py-3 text-center text-slate-700">{getDiscountDisplay(product.listPrice, product.discount)}</td>
                                  {yearlyPrices.map((price, yearIndex) => (
                                    <td key={yearIndex} className="border border-slate-200 px-4 py-3 text-right">
                                      {product.waiveYear1 && yearIndex === 0 ? (
                                        <div>
                                          <div className="line-through text-slate-400">{formatCurrency(price)}</div>
                                          <div className="text-red-600 font-bold text-xs">WAIVED</div>
                                        </div>
                                      ) : (
                                        <span className="text-slate-800 font-medium">{formatCurrency(price)}</span>
                                      )}
                                    </td>
                                  ))}
                                  <td className="border border-slate-200 px-4 py-3 text-right font-bold text-slate-800 bg-orange-50">
                                    {formatCurrency(productSubscriptionTotal)}
                                  </td>
                                </tr>
                                
                                {product.hasImplementation && (
                                  <tr className={`${rowColor} hover:bg-blue-50 transition-colors`}>
                                    <td className="border border-slate-200 px-4 py-3 font-medium pl-8 text-slate-600">Implementation</td>
                                    <td className="border border-slate-200 px-4 py-3 text-center text-slate-500">-</td>
                                    <td className="border border-slate-200 px-4 py-3 text-right text-slate-700">{formatCurrency(product.implementationCost)}</td>
                                    <td className="border border-slate-200 px-4 py-3 text-center text-slate-700">{getDiscountDisplay(product.implementationCost, product.implementationDiscount)}</td>
                                    {Array.from({length: term}, (_, yearIndex) => {
                                        const discountedImplCost = product.waiveImplementation ? 0 : calculateDiscountedPrice(product.implementationCost, product.implementationDiscount);
                                        let displayValue = '-';
                                        if(discountedImplCost > 0) {
                                            if (product.spreadImplementation) {
                                                displayValue = formatCurrency(Math.round(discountedImplCost / term));
                                            } else if (yearIndex === 0) {
                                                displayValue = formatCurrency(discountedImplCost);
                                            }
                                        }
                                        return (
                                            <td key={yearIndex} className="border border-slate-200 px-4 py-3 text-right">
                                                {product.waiveImplementation ? <div className="text-red-600 font-bold text-xs">WAIVED</div> : <span>{displayValue}</span>}
                                            </td>
                                        );
                                    })}
                                    <td className="border border-slate-200 px-4 py-3 text-right font-bold text-slate-800 bg-orange-50">
                                      {product.waiveImplementation ? 'WAIVED' : formatCurrency(calculateDiscountedPrice(product.implementationCost, product.implementationDiscount))}
                                    </td>
                                  </tr>
                                )}
                              </React.Fragment>
                            );
                          })}
                          
                          <tr className="bg-slate-800 text-white font-bold">
                            <td className="border border-slate-500 px-4 py-4 text-lg">TOTAL</td>
                            <td className="border border-slate-500 px-4 py-4 text-center">-</td>
                            <td className="border border-slate-500 px-4 py-4 text-right">
                              {formatCurrency(products.reduce((sum, p) => sum + p.listPrice + (p.hasImplementation ? p.implementationCost : 0), 0))}
                            </td>
                            <td className="border border-slate-500 px-4 py-4 text-center text-lg">{averageDiscount}%</td>
                            {Array.from({length: term}, (_, yearIndex) => {
                              const yearTotal = products.reduce((sum, product) => {
                                const yearlyPrice = calculateYearlyPrice(product.listPrice, yearIndex + 1, escalator);
                                const discountedPrice = calculateDiscountedPrice(yearlyPrice, product.discount);
                                let finalPrice = product.waiveYear1 && yearIndex === 0 ? 0 : discountedPrice;
                                
                                if (product.hasImplementation && !product.waiveImplementation) {
                                    const implCost = calculateDiscountedPrice(product.implementationCost, product.implementationDiscount);
                                    if (product.spreadImplementation) {
                                        finalPrice += Math.round(implCost / term);
                                    } else if (yearIndex === 0) {
                                        finalPrice += implCost;
                                    }
                                }
                                return sum + finalPrice;
                              }, 0);
                              
                              return (
                                <td key={yearIndex} className="border border-slate-500 px-4 py-4 text-right text-lg">
                                  {formatCurrency(yearTotal)}
                                </td>
                              );
                            })}
                            <td className="border border-slate-500 px-4 py-4 text-right text-xl" style={{backgroundColor: '#f57922'}}>
                              {formatCurrency(totals.totalDiscountedPrice)}
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div className="text-sm text-slate-500 italic mb-8 text-center">
                      {hasCurrentSolution && <span>* Currently Used Solution<br/></span>}
                      *Implementation can be spread over the term of the contract
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                      <div className="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-6 shadow-lg">
                        <div className="flex items-center gap-4 mb-3">
                          <div className="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <div className="w-5 h-5 text-white"><DollarSign /></div>
                          </div>
                          <div>
                            <div className="text-3xl font-bold text-blue-800">{formatCurrency(totals.totalDiscountedPrice)}</div>
                            <div className="text-blue-600 font-medium">Total Investment</div>
                          </div>
                        </div>
                        <div className="text-blue-700 text-sm">Total cost over {term}-year contract term</div>
                      </div>
                      
                      <div className="bg-gradient-to-br from-green-50 to-green-100 border border-green-200 rounded-xl p-6 shadow-lg">
                        <div className="flex items-center gap-4 mb-3">
                          <div className="w-12 h-12 bg-green-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <div className="w-5 h-5 text-white"><Calculator /></div>
                          </div>
                          <div>
                            <div className="text-3xl font-bold text-green-800">{formatCurrency(totals.totalSavings)}</div>
                            <div className="text-green-600 font-medium">Total Savings</div>
                          </div>
                        </div>
                        <div className="text-green-700 text-sm">Compared to list price over contract term ({averageDiscount}% avg. discount) with a {STANDARD_ESCALATOR}% annual escalator.</div>
                      </div>
                    </div>

                    <div className="flex justify-center sm:justify-end items-center pt-6 border-t border-slate-200">
                      <button 
                        onClick={copyToPowerPoint} 
                        className="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 px-6 py-3 rounded-xl flex items-center gap-2 text-sm font-semibold transition-all duration-200 text-white shadow-lg hover:shadow-xl hover:scale-105 w-full sm:w-auto justify-center"
                      >
                        <div className="w-4 h-4"><Copy /></div>
                        Copy to PowerPoint
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        );
      };

      // --- Mount the React App ---
      const container = document.getElementById('root');
      const root = ReactDOM.createRoot(container);
      root.render(<App />);

    </script>
</body>
</html>
